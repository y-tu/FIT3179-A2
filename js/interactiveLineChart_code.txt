{
  "config": {"view": {"stroke": null}},
    "$schema" : "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {
    "url": "https://raw.githubusercontent.com/y-tu/FIT3179-A2/main/data/pupil_to_teacher_ratio(primary).csv"
  },
  "vconcat": [
    {
      "width": 750,
      "height":400,
      "layer": [
        {
          "transform": [
            {
              "filter": {
                "field": "Region",
                "oneOf": [
                  "East Asia & Pacific",
                  "Europe & Central Asia",
                  "North America",
                  "South Asia",
                  "Sub-Saharan Africa"
                ]
              }
            }
          ],
          "mark": "line",
          "encoding": {
            "x": {
              "timeUnit": "year",
              "field": "Year",
              "type": "temporal",
              "scale": {"domain": {"param": "time_brush"}},
              "title": "",
              "axis": {"domain": true, "grid": false, "ticks": true, "labelFont": "Open Sans", "labelPadding": 5}
            },
            "y": {
              "field": "pupil_teacher",
              "type": "quantitative",
              "title": "Pupil To Teacher Ratio",
              "axis": {"domain": true, "grid": false, "ticks": true, "titleFontSize": 13, "labelFont": "Open Sans", "labelPadding": 5}
            },
            "color": {
              "field": "Region",
              "type": "nominal",
              "title": "World Region",
              "scale": {
                "domain": [
                  "East Asia & Pacific",
                  "Europe & Central Asia",
                  "North America",
                  "South Asia",
                  "Sub-Saharan Africa",
                  "World"
                ],
                "range": [
                  "#dfc27d",
                  "#35978f",
                  "#01665e",
                  "#8c510a",
                  "#bf812d",
                  "#c7eae5"
                ]
              }
            },
            "tooltip": [
              {
                "field": "Region",
                "type": "nominal",
                "title": "World Region"
              },
              {
                "field": "pupil_teacher",
                "type": "quantitative",
                "title": "Pupil To Teacher Ratio",
                "format": ".2f"
              }
            ]
          }
        }
      ]
    },
    {
      "transform": [{"filter": "datum.Region=='World'"}],
      "width": 750,
      "height": 60,
      "layer": [
        {
          "mark": "area",
          "params": [
            {
              "name": "time_brush",
              "select": {"type": "interval", "encodings": ["x"]}
            }
          ],
          "encoding": {
            "x": {
              "field": "Year",
              "type": "temporal",
              "timeUnit": "year",
              "title": "Year",
              "axis": {"domain": true, "grid": false, "ticks": true, "titleFontSize": 13, "labelFont": "Open Sans", "labelPadding": 5}
            },
            "y": {
              "field": "pupil_teacher",
              "type": "quantitative",
              "title": "",
              "axis": {"domain": true, "grid": false, "ticks": true, "titleFontSize": 13, "labelFont": "Open Sans", "labelPadding": 5}
            },
            "color": {"field": "Region", "type": "nominal"}
          }
        },
        {
          "layer": [
            {
              "mark": {"type": "rule", "color": "#878787", "size": 2},
              "encoding": {"x": {"field": "date", "type": "temporal"}},
              "data": {
                "values": [
                  {"date": "2015"},
                  {"date": "1983"},
                  {"date": "2001"}
                ],
                "format": {"parse": {"date": "utc:'%Y'"}}
              }
            },
            {
              "transform": [
                {
                  "calculate": "'2015: Lowest Pupil; to Teacher Ratio' ",
                  "as": "first_text_annotation_raw"
                },
                {
                  "calculate": "split(datum.first_text_annotation_raw, ';')",
                  "as": "first_text_annotation"
                },
                {
                  "calculate": "'1983 Highest Pupil:; to Teacher Ratio' ",
                  "as": "second_text_annotation_raw"
                },
                {
                  "calculate": "split(datum.second_text_annotation_raw, ';')",
                  "as": "second_text_annotation"
                },
                {
                  "calculate": "'2001: No Child Left; Behind Act Passed' ",
                  "as": "third_text_annotation_raw"
                },
                {
                  "calculate": "split(datum.third_text_annotation_raw, ';')",
                  "as": "third_text_annotation"
                }
              ],
              "layer": [
                {
                  "mark": {
                    "type": "text",
                    "align": "right",
                    "baseline": "top",
                    "dx": 350,
                    "dy": -60,
                    "fontSize": 11,
                    "fontWeight": 200,
                    "color": "#878787"
                  },
                  "encoding": {"text": {"field": "first_text_annotation"}}
                },
                {
                  "mark": {
                    "type": "text",
                    "align": "right",
                    "baseline": "top",
                    "dx": -310,
                    "dy": -60,
                    "fontSize": 11,
                    "color": "#878787"
                  },
                  "encoding": {"text": {"field": "second_text_annotation"}}
                },
                {
                  "mark": {
                    "type": "text",
                    "align": "right",
                    "baseline": "top",
                    "dx": 50,
                    "dy": -60,
                    "fontSize": 11,
                    "color": "#878787"
                  },
                  "encoding": {"text": {"field": "third_text_annotation"}}
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}